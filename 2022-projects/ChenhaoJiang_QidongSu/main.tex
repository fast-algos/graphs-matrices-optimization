\documentclass[11pt]{article}
\usepackage{bbm}
% \usepackage{subcaption}
\def\showauthornotes{1}
\def\showkeys{0}
\def\showdraftbox{0}
\let\pref=\prettyref

\title{CSC 2240 Report: Spectral Partitioning Works: Planar graphs and finite element meshes}
\author{Chenhao Jiang, Qidong Su}
\date{December 2022}

\input{macro}

\begin{document}

\maketitle

\section{Introduction}

\subsection{Motivation}

Graph partitioning is widely used in many scientific numerical applications, such as mapping finite element calculations on parallel machines. A good partition should be able to \textbf{minimize the edge cut} while \textbf{keep the workload balanced among partitions}. A special case is a bisection, which partitions the graph into two parts differing in size by at most 1.

Spectral partitioning is a family of algorithms associated with the second smallest eigenvalue and its corresponding eigenvectors of the Laplacian matrix. In this paper, the authors give a upper bound of the size of bisections generated by spectral partitioning on two classes of graphs: 1) bounded-degree planar graphs; 2) well-shaped meshes.

We will focus on the bounded degree planar graphs in this report as the second case is a natural generalization to higher-dimensional spaces.

\subsection{Terminology}
We omit the concepts like Laplacian matrix as they're covered and commonly used in the course.

\paragraph{partition} A partition of a graph $G$ is a division of its vertices into two disjoint subsets, $A$ and $\overline{A}$.

\paragraph{bisection} A partition is a bisection when $A$ and $\overline{A}$ differ in size by at most $1$.

\paragraph{$\delta$-seperator} For $0 < \delta \leq 2$, a partition is called \textit{$\delta$-seperator} if $\min(|A|,|\overline{A}|) \geq \delta n$.

\paragraph{cut size} Let $E(A, \overline{A})$ be the set of edges with one endpoint in $A$ and the other in $\overline{A}$. The cut size is $|E(A, \overline{A})|$

\paragraph{cut ratio} $\phi(A,\overline{A})=\frac{|E(A, \overline{A})|}{\min(|A|, |\overline{A}|)}$. It is slightly different with \textit{conductance} we learned in lectures, which is  $\frac{|E(A, \overline{A})|}{\min\left(\texttt{vol}(A), \texttt{wol}(\overline{A})\right)}$

\paragraph{isoperimetric number}
$\phi(G) = \min_{|A| \leq n/2} \frac{|E(A, \overline{A})|}{|A|}$. The isoperimetric number measures how good a ratio cut one can hope to find.

\paragraph{Fiedler value and vector}
They are the second smallest eigenvalue and its corresponding eigen vector of the Laplacian matrix.

\subsection{Outline}
In Section \ref{sp} we will introduce the spectral partition algorithm minimizing the cut ratio without considering balance. Then in Section \ref{bisection}, we'll show a algorithm iteratively calling spectral partitioning to produce a bisection with small cut. In section \ref{planar}, we'll show its application on bounded-degree planar graphs.

\subsection{Spectral Partition}\label{sp}
Let $\uu = (u_1, \dots, u_n)$ be a Fiedler vector of the Laplacian of a graph $G$. The idea of spectral partitioning is to find a splitting value $s$ and partition the vertices of $G$ into the set of $i$ such that $u_i > s$ and the set such that $u_i \leq s$. We call such a partition a \textit{Fielder cut}. There are several popular choices for the splitting value $s$:

\begin{itemize}
\item bisection: $s$ is the medium of $\{u_1,\dots, u_n\}$.
\item ratio cut: $s$ is the value that gives the best ratio cut.
\item sign cut: $s=0$
\item gap cut: $s$ is a value in the largest gap in the sorted list of Fiedler vector components
\end{itemize}

In this paper, authors analyze the spectral method that uses the splitting value that achieves the best ratio cut.

The Fiedler value $\lambda_2$ is closely linked to the isoperimetric number of the graph. If $G$ is a graph on more than three nodes, then one can show
$$
\frac{\lambda_2}{2} \leq \phi(G) \leq \sqrt{\lambda_2 (2d-\lambda_2)}
$$
where $d$ is the maximum degree.

\begin{remark}
It is slightly different from Cheeger's inequality we learned in class, since it uses unnormalized Laplacian.
\end{remark}

This inequality bounds the range of the isoperimetric value $\phi(G)$ using Fiedler value $\lambda_2$. But $\phi$ only measures the lower limit of cut ratio, but not the minimum cut ratio that \textbf{can be found by spectral partitioning}. The following theorem links $\lambda_2$ with the cut ratio given by the spectral partitioning.

\begin{theorem}[Mihail\cite{mihail1989conductance}]\label{mihail}
Let $G=(V,E)$ be a graphon $n$ nodes of maximum degree $d$, let $Q$ be its Laplacian matrix, and let $\phi$ be its isoperimetric number. For any vector $\xx \in R^n$ such that $\sum_{i=1}^n x_i = 0$,
$$
\frac{\xx^\top Q \xx}{\xx^\top \xx} \geq \frac{\phi^2}{2d}
$$

Moreover, there is an $s$ so that the cut $(\{i~:~x_i \leq s\}, \{i~:~x_i > s\})$ had ratio at most $\sqrt{2d\frac{\xx^\top Q \xx}{\xx^\top\xx}}$
\end{theorem}

If we choose the $\xx$ that minimizes $\frac{\xx^\top Q \xx}{\xx^\top\xx}$, then by the definition of Rayleigh quotient, $\frac{\xx^\top Q \xx}{\xx^\top\xx} = \lambda_2$. So we can always find an $s$ so that the cut ratio is smaller than $\sqrt{2d\lambda_2}$.

\section{From Partition to Bisection}\label{bisection}

Spectral partitioning we use splits the vertices to minimize the ratio cut, but doesn't take balance into consideration. It has no guarantee about the difference in size between the two parts.

In this part, we show that given an algorithm that can find cuts of ratio $\phi$ in $G$ and its subgraphs, we can find a \textbf{bisector} of $G$ of size $O(\phi n)$.

\begin{lemma}\label{A1_lemma}
Assume that we are given an algorithm that will find a cut of ratio at most $\phi(k)$ in every $k$-node subgraph of $G$, for some monotonically decreasing function $\phi$. Then repeated application of this algorithm (as in Algorithm~\ref{alg:bisection} and Figure~\ref{fig:bisection}) can be used to find a bisection of $G$ of size at most
$$
\int_{x=1}^n \phi(x) \dif x
$$
\end{lemma}

\begin{figure}
\centering
\includegraphics[width=0.6\textwidth]{figures/bisection.jpg}
\caption{Algorithm to find a bisection iteratively}
\label{fig:bisection}
\end{figure}

\begin{algorithm}
\caption{An algorithm to find a bisection}\label{alg:bisection}
\begin{algorithmic}[1]
\Require $G=(V,E)$, partition algorithm $P$ with bounded cut ratio $\phi$
\Ensure A bisection $(A, B)$ which satisfies the bound

\State $D^0 \gets G$, $A=\emptyset$, $B=\emptyset$, $i=0$
\While{$D^i \neq \emptyset$}
    \State $F^i,\overline{F^i} = P(D^i)$. Assume $|F^i| < |\overline{F^i}|$.
    \If{$|A| \leq |B|$}
        \State $A \gets A \cup F^i$
    \Else
        \State $B \gets B \cup F^i$
    \EndIf
    \State $D^{i+1} \gets \overline{F^i}$, $i \gets i+1$
\EndWhile
\end{algorithmic}
\end{algorithm}

\begin{proof}
First, we show it produces a bisection. Suppose the algorithm stops after $t$ steps. It suffices to show that for all $0 \leq t < t$, $\min(|A|, |B|) + |F^i| \leq n/2$. Because $|F^i| \leq |\overline{F^i}|$, we have 
$$
\min(|A|, |B|) + |F^i| \leq (|A| + |B| + |F^i| + |\overline{F^i}|)/2 = n/2
$$

Then we analyze the total cut size. In the $i$-th iteration, the cut ratio of $(F^i, \overline{F^i})$ is at most $\phi(|D^i|)$, so the total number of cut edges is at most

\begin{align*}
    \phi(|D^i|)|F^i| &= \sum_{j=1}^{|F^i|} \phi(|D^i|) && \text{(expand the multiplication)}\\
    &= \sum_{j=|D^i| - |F^i| + 1}^{|D^i|} \phi(|D^i|)\\
    &\leq \sum_{j=|D^i| - |F^i| + 1}^{|D^i|} \phi(j)
\end{align*}

The last inequality follows from that $\phi$ is monotonically decreasing. The total number of cut edges given by the algorithm is:

\begin{align*}
\sum_i^{t-1} \phi(|D^i|) |F^i| &\leq \sum_{i=0}^{t-1} \left( \sum_{j=|D^i| - |F^i| + 1}^{|D^i|} \phi(j) \right) \\
&= \sum_{j=1}^n \phi(j) && \text{($|D^i-1| + |F^i| = |D^i|$)} \\
&\leq \int_1^n \phi(x) \dif x && \text{($\phi$ is monotonically decreasing)}
\end{align*}

\end{proof}

\begin{remark}
If $\phi(x)=x^{-1/d}$ then 
$$
\int_i^n \phi(x) \dif x = \frac{d}{d-1} (n^{1-1/d} -1).
$$
That is $O(\phi n)$ we mentioned above.
\end{remark}

\section{Planar Graph}\label{planar}
\input{planar_graph.tex}
\section{Sphere Preserving Map}\label{planar}
\input{sphere_pre_map.tex}
% \section{Sphere-Preserving mapping}
% \section{Well-Shaped Meshes}

\bibliographystyle{plainnat}
\bibliography{ref.bib}

\end{document}
